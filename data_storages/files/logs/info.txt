  Mailing Unhandled(Critical) Error. Location: send_recordings_on_recording_completed
Error: Object <LessonWithAbsentChildren at 0x1fcf82b18d0> cannot be converted to 'persistent' state, as this identity map is no longer valid.  Has the owning Session been closed? (Background on this error at: https://sqlalche.me/e/20/lkrp)
Input (lesson/zoom json): {'payload': {'account_id': 'n9D1u_kRQhe-GBbRTpT4mQ', 'object': {'uuid': 'LjtP8z2jS0qmRJIIb1WuBg==', 'id': 85392858403, 'account_id': 'n9D1u_kRQhe-GBbRTpT4mQ', 'host_id': 'c7qNTbLwTU6CzokdhwEjkg', 'topic': 'Elementary 2_1 зум 19:00 [158]', 'type': 8, 'start_time': '2023-11-01T16:00:50Z', 'timezone': 'Europe/Moscow', 'host_email': 'supra.12@supraschool.ru', 'duration': 67, 'total_size': 310615812, 'recording_count': 4, 'share_url': 'generated_url_for_Elementary 2_1', 'recording_files': [{}], 'password': '9$If6&tn', 'recording_play_passcode': 'generated_passcode', 'on_prem': False}}, 'event_ts': 1700160240202, 'event': 'recording.completed', 'download_token': 'eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJodHRwczovL2V2ZW50Lnpvb20udXMiLCJhY2NvdW50SWQiOiJuOUQxdV9rUlFoZS1HQmJSVHBUNG1RIiwiYXVkIjoiaHR0cHM6Ly9vYXV0aC56b29tLnVzIiwibWlkIjoiTGp0UDh6MmpTMHFtUkpJSWIxV3VCZz09IiwiZXhwIjoxNzAwMjQ2NjU1LCJ1c2VySWQiOiJjN3FOVGJMd1RVNkN6b2tkaHdFamtnIn0.ptMuRTBS417TqUCyZTCPG-Bq4omMrNqpgt6J46zYOuIARoCtkPaNNlQl2bF2e6JnvUgDS8dTBHz7McwF5ofFSw'}
Traceback: Traceback (most recent call last):
  File "C:\Users\ChipChopa\Desktop\portfolio\Python\SupraHelperBot\exceptions\mailing_error_handler.py", line 15, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\Desktop\portfolio\Python\SupraHelperBot\services\mailing\mailer.py", line 28, in send_recordings_on_recording_completed
    RecordingMailerOnRecordingCompleted.send(self.bot, zoom_json)
  File "C:\Users\ChipChopa\Desktop\portfolio\Python\SupraHelperBot\services\mailing\send_recordings_on_recording_completed.py", line 21, in send
    lesson, absent_children = RecordingMailerOnRecordingCompleted._get_lesson_and_absent_children(group_id, room_num, moscow_date_y_m_d, zoom_topic)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\Desktop\portfolio\Python\SupraHelperBot\services\mailing\send_recordings_on_recording_completed.py", line 41, in _get_lesson_and_absent_children
    group_lessons_with_abs_children_on_day = LessonWithAbsentChildrenRepository.find_by_group_id_and_room_num_and_date(
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\Desktop\portfolio\Python\SupraHelperBot\data_storages\db\repositories\lesson_with_absent_child_repository.py", line 36, in find_by_group_id_and_room_num_and_date
    ).all()
      ^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 2688, in all
    return self._iter().all()  # type: ignore
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\result.py", line 1786, in all
    return self._allrows()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\result.py", line 554, in _allrows
    rows = self._fetchall_impl()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\result.py", line 1693, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\result.py", line 2293, in _fetchall_impl
    return list(self.iterator)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py", line 195, in chunks
    rows = [proc(row) for row in fetch]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py", line 195, in <listcomp>
    rows = [proc(row) for row in fetch]
            ^^^^^^^^^
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\loading.py", line 1078, in _instance
    session_identity_map._add_unpresent(state, identitykey)
  File "C:\Users\ChipChopa\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\identity.py", line 297, in _killed
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Object <LessonWithAbsentChildren at 0x1fcf82b18d0> cannot be converted to 'persistent' state, as this identity map is no longer valid.  Has the owning Session been closed? (Background on this error at: https://sqlalche.me/e/20/lkrp)